@rendermode InteractiveServer

<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Connection String *</label>
    <textarea @bind="Config.ConnectionString" @bind:event="oninput" @bind:after="NotifyConfigChanged"
              rows="3"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md font-mono text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
              placeholder="DefaultEndpointsProtocol=https;AccountName=...;AccountKey=...;EndpointSuffix=core.windows.net"></textarea>
    <p class="text-xs text-gray-500 mt-1">Azure Storage account connection string. Leave unchanged to keep existing value.</p>
</div>

<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Container Name *</label>
    <input type="text" @bind="Config.ContainerName" @bind:event="oninput" @bind:after="NotifyConfigChanged"
           required
           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"
           placeholder="exports" />
    <p class="text-xs text-gray-500 mt-1">Azure Blob container name (lowercase, no spaces)</p>
</div>

<div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Blob Prefix (Optional)</label>
    <input type="text" @bind="Config.BlobPrefix" @bind:event="oninput" @bind:after="NotifyConfigChanged"
           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"
           placeholder="reports/" />
    <p class="text-xs text-gray-500 mt-1">Optional folder path within container (e.g., reports/2024/)</p>
</div>

<div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4">
    <div class="flex items-start">
        <i data-lucide="info" class="w-4 h-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0"></i>
        <div class="text-xs text-blue-800">
            <strong>Note:</strong> You can find your connection string in the Azure Portal under Storage Account â†’ Access Keys.
        </div>
    </div>
</div>

@code {
    [Parameter] public DestinationConfiguration Config { get; set; } = new();
    [Parameter] public EventCallback<DestinationConfiguration> ConfigChanged { get; set; }

    private async Task NotifyConfigChanged()
    {
        await ConfigChanged.InvokeAsync(Config);
    }
}
