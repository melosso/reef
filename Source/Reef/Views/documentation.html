<!--REEF:TITLE-->Documentation · Reef<!--/REEF:TITLE-->
<!--REEF:SCRIPTS--><script src="/assets/js/_mermaid.10.9.0.js"></script><!--/REEF:SCRIPTS-->
<div class="flex-1 flex flex-col overflow-hidden">
            <header class="bg-white shadow-sm z-10">
                <div class="flex items-center justify-between px-6 py-4">
                    <h1 class="text-2xl font-semibold text-gray-900 disable-select">Documentation</h1>
                </div>
            </header>

            <main class="flex-1 overflow-y-auto bg-gray-50 p-6">
                <!-- Main Tabs Navigation -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6">
                    <div class="flex border-b border-gray-300">
                        <button onclick="showMainTab('profiles')" id="tab-profiles" class="px-6 py-4 text-blue-600 border-b-2 border-blue-600 hover:bg-blue-50 transition-colors">
                            <div class="flex items-center gap-2">
                                <i data-lucide="file-code" class="h-5 w-5"></i>
                                <span>Profiles</span>
                            </div>
                        </button>
                        <button onclick="showMainTab('jobs')" id="tab-jobs" class="px-6 py-4 text-gray-600 hover:bg-gray-50 hover:text-gray-900 transition-colors">
                            <div class="flex items-center gap-2">
                                <i data-lucide="briefcase" class="h-5 w-5"></i>
                                <span>Jobs</span>
                            </div>
                        </button>
                    </div>

                    <!-- Profiles Tab Content -->
                    <div id="content-profiles" class="tab-content">
                        <!-- View Selection Toolbar -->
                        <div class="bg-gray-50 border-b border-gray-200 px-6 py-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-6">
                                    <div class="flex items-center gap-2 bg-white border border-gray-300 rounded-lg">
                                        <button onclick="showProfileView('overview')" id="tab-profile-overview" class="px-4 py-2 font-medium text-blue-600 border-r border-gray-300 hover:bg-blue-50 transition-colors rounded-l-md">
                                            <div class="flex items-center gap-1">
                                                <i data-lucide="trending-up-down" class="h-4 w-4"></i>
                                                Flowchart
                                            </div>
                                        </button>
                                        <button onclick="showProfileView('relationship')" id="tab-profile-relationship" class="px-4 py-2 font-medium text-gray-600 hover:bg-gray-50 transition-colors rounded-r-md">
                                            <div class="flex items-center gap-1">
                                                <i data-lucide="share-2" class="h-4 w-4"></i>
                                                Relationships
                                            </div>
                                        </button>
                                    </div>
                                    <div class="border-l border-gray-300 pl-6">
                                        <label for="profile-select" class="text-sm font-medium text-gray-700 mr-3">Focus:</label>
                                        <select id="profile-select" onchange="handleProfileSelection()" class="px-3 py-2 border border-gray-300 rounded-lg text-sm inline-block">
                                            <option value="">All Profiles</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="relative group">
                                        <button class="inline-flex items-center gap-1 px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors" data-tooltip="Download">
                                            <i data-lucide="download" class="h-4 w-4"></i>
                                        </button>
                                        <div class="absolute right-0 mt-0 w-40 bg-white border border-gray-300 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10">
                                            <button onclick="downloadProfileDiagramAsWebP()" data-tooltip="Download as Image" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 first:rounded-t-md">
                                                Image
                                            </button>
                                            <button onclick="downloadProfileDiagramAsMermaid()" data-tooltip="Download as Mermaid" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 last:rounded-b-md border-t border-gray-200">
                                                Mermaid
                                            </button>
                                        </div>
                                    </div>
                                    <button onclick="resetProfileZoom()" class="inline-flex items-center gap-1 px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors" data-tooltip="Reset zoom">
                                        <i data-lucide="maximize-2" class="h-4 w-4"></i>
                                    </button>
                                    <button onclick="refreshProfileDiagrams()" class="inline-flex items-center gap-1 px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors" data-tooltip="Refresh">
                                        <i data-lucide="refresh-cw" class="h-4 w-4"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">
                                <i data-lucide="zap" class="h-3 w-3 inline mr-1"></i>Drag to pan • Scroll to zoom
                            </div>
                        </div>

                        <!-- Profile diagram container -->
                        <div class="p-6">
                            <div id="profile-diagram-container" class="bg-white border border-gray-200 rounded-lg overflow-auto" style="min-height: 500px; max-height: calc(100vh - 520px);">
                                <div id="profile-diagram" class="mermaid w-full h-full text-white"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Jobs Tab Content -->
                    <div id="content-jobs" class="tab-content hidden">
                        <!-- View Selection Toolbar -->
                        <div class="bg-gray-50 border-b border-gray-200 px-6 py-3">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center gap-6">
                                    <div class="flex items-center gap-2 bg-white border border-gray-300 rounded-lg">
                                        <button onclick="showJobView('overview')" id="tab-job-overview" class="px-4 py-2 font-medium text-blue-600 border-r border-gray-300 hover:bg-blue-50 transition-colors rounded-l-md">
                                            <div class="flex items-center gap-1">
                                                <i data-lucide="trending-up-down" class="h-4 w-4"></i>
                                                Flowchart
                                            </div>
                                        </button>
                                        <button onclick="showJobView('relationship')" id="tab-job-relationship" class="px-4 py-2 font-medium text-gray-600 hover:bg-gray-50 transition-colors rounded-r-md">
                                            <div class="flex items-center gap-1">
                                                <i data-lucide="share-2" class="h-4 w-4"></i>
                                                Relationships
                                            </div>
                                        </button>
                                    </div>
                                    <div class="border-l border-gray-300 pl-6">
                                        <label for="job-select" class="text-sm font-medium text-gray-700 mr-3">Focus:</label>
                                        <select id="job-select" onchange="handleJobSelection()" class="px-3 py-2 border border-gray-300 rounded-lg text-sm inline-block">
                                            <option value="">All Jobs</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="flex items-center gap-2">
                                    <div class="relative group">
                                        <button class="inline-flex items-center gap-1 px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors" data-tooltip="Download">
                                            <i data-lucide="download" class="h-4 w-4"></i>
                                        </button>
                                        <div class="absolute right-0 mt-0 w-40 bg-white border border-gray-300 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10">
                                            <button onclick="downloadJobDiagramAsWebP()" data-tooltip="Download as Image" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 first:rounded-t-md">
                                                Image
                                            </button>
                                            <button onclick="downloadJobDiagramAsMermaid()" data-tooltip="Download as Mermaid" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 last:rounded-b-md border-t border-gray-200">
                                                Mermaid
                                            </button>
                                        </div>
                                    </div>
                                    <button onclick="resetJobZoom()" class="inline-flex items-center gap-1 px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors" data-tooltip="Reset zoom">
                                        <i data-lucide="maximize-2" class="h-4 w-4"></i>
                                    </button>
                                    <button onclick="refreshJobDiagrams()" class="inline-flex items-center gap-1 px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors" data-tooltip="Refresh">
                                        <i data-lucide="refresh-cw" class="h-4 w-4"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">
                                <i data-lucide="zap" class="h-3 w-3 inline mr-1"></i>Drag to pan • Scroll to zoom
                            </div>
                        </div>

                        <!-- Job diagram container -->
                        <div class="p-6">
                            <div id="job-diagram-container" class="bg-white border border-gray-200 rounded-lg overflow-auto" style="min-height: 500px; max-height: calc(100vh - 520px);">
                                <div id="job-diagram" class="mermaid w-full h-full text-white"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Legend -->
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Legend</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded" style="background-color: #4F46E5;"></div>
                            <span class="text-sm text-gray-700">Connection</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded" style="background-color: #10B981;"></div>
                            <span class="text-sm text-gray-700">Profile/Job</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded" style="background-color: #8B5CF6;"></div>
                            <span class="text-sm text-gray-700">Transform</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded" style="background-color: #06B6D4;"></div>
                            <span class="text-sm text-gray-700">Destination</span>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        let userMenuExpanded = false;

        function toggleUserMenu() {
            const menu = document.getElementById('user-menu');
            const chevron = document.getElementById('chevron-icon');
            userMenuExpanded = !userMenuExpanded;
            
            if (userMenuExpanded) {
                menu.classList.remove('user-menu-collapsed');
                menu.classList.add('user-menu-expanded');
                chevron.style.transform = 'rotate(180deg)';
            } else {
                menu.classList.remove('user-menu-expanded');
                menu.classList.add('user-menu-collapsed');
                chevron.style.transform = 'rotate(0deg)';
            }
            
            setTimeout(() => queueLucideRender(), 50);
        }

        function logout() {
            clearAuth();
            redirectToLogin();
        }

        queueLucideRender();
    </script>
    <script src="/assets/js/documentation.js"></script>
</body>
</html>
